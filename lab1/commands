# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ —Ñ–æ–Ω–µ
docker-compose up -d

# 2. –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è
docker-compose exec postgres psql -U lab -d database

# –î–ª—è Ubuntu/Debian:
sudo systemctl stop postgresql
sudo systemctl disable postgresql  # (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —á—Ç–æ–±—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞–ª—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ)

# –í–Ω—É—Ç—Ä–∏ psql –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã:
# \l          - —Å–ø–∏—Å–æ–∫ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
# \c pagila   - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ pagila
# \dt         - —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
# \q          - –≤—ã—Ö–æ–¥

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose down

docker exec -it lab1-postgres-1 psql -U lab -d database

# ‚úÖ 1. –£–∑–Ω–∞—Ç—å —Ä–∞–∑–º–µ—Ä –∫–∞–∂–¥–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
SELECT
    datname AS "–ò–º—è –±–∞–∑—ã",
    pg_size_pretty(pg_database_size(datname)) AS "–†–∞–∑–º–µ—Ä",
    pg_database_size(datname) AS "–†–∞–∑–º–µ—Ä (–±–∞–π—Ç—ã)"
FROM
    pg_database
ORDER BY
    pg_database_size(datname) DESC;


#‚úÖ 1. –ü–æ—Å–º–æ—Ç—Ä–∏–º —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü –≤ demo
\dt
#‚úÖ 2. –£–∑–Ω–∞–µ–º —Ä–∞–∑–º–µ—Ä –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã
SELECT
    schemaname AS "–°—Ö–µ–º–∞",
    tablename AS "–¢–∞–±–ª–∏—Ü–∞",
    pg_size_pretty(pg_total_relation_size(schemaname || '.' || tablename)) AS "–†–∞–∑–º–µ—Ä",
    pg_size_pretty(pg_relation_size(schemaname || '.' || tablename)) AS "–î–∞–Ω–Ω—ã–µ",
    pg_size_pretty(pg_indexes_size(schemaname || '.' || tablename)) AS "–ò–Ω–¥–µ–∫—Å—ã",
    (SELECT reltuples::BIGINT FROM pg_class c JOIN pg_namespace n ON n.oid = c.relnamespace
     WHERE n.nspname = schemaname AND c.relname = tablename) AS "–°—Ç—Ä–æ–∫ (–æ—Ü–µ–Ω–∫–∞)"
FROM
    pg_tables
WHERE
    schemaname NOT IN ('pg_catalog', 'information_schema')
ORDER BY
    pg_total_relation_size(schemaname || '.' || tablename) DESC
LIMIT 20;

#‚úÖ 4. –ü–æ—Å–º–æ—Ç—Ä–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–ª—é—á–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã
\d –∏–º—è_—Ç–∞–±–ª–∏—Ü—ã

#‚úÖ 6. –ü—Ä–æ–≤–µ—Ä–∏–º, –µ—Å—Ç—å –ª–∏ –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏ –∏ —Å–≤—è–∑–∏ –ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —Ç–∞–±–ª–∏—Ü—ã —Å–≤—è–∑–∞–Ω—ã –º–µ–∂–¥—É —Å–æ–±–æ–π:
SELECT
    tc.table_schema,
    tc.table_name,
    kcu.column_name,
    ccu.table_name AS foreign_table_name,
    ccu.column_name AS foreign_column_name
FROM
    information_schema.table_constraints AS tc
JOIN information_schema.key_column_usage AS kcu
    ON tc.constraint_name = kcu.constraint_name
JOIN information_schema.constraint_column_usage AS ccu
    ON ccu.constraint_name = tc.constraint_name
WHERE
    tc.constraint_type = 'FOREIGN KEY'
    AND tc.table_schema NOT IN ('pg_catalog', 'information_schema');

# SQL commands
–ü–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ (SELECT)
–î–æ–±–∞–≤–ª—è—Ç—å (INSERT)
–ú–µ–Ω—è—Ç—å (UPDATE)
–£–¥–∞–ª—è—Ç—å (DELETE)
–°–æ–∑–¥–∞–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã (CREATE TABLE)
–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å (GROUP BY, JOIN, WHERE)

# SQL SELECT
SELECT * FROM users LIMIT 5; 
* ‚Äî –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã
LIMIT 5 ‚Äî —Ç–æ–ª—å–∫–æ 5 —Å—Ç—Ä–æ–∫ (—á—Ç–æ–±—ã –Ω–µ –≥—Ä—É–∑–∏—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª) 



#DUMP
; üëâ –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞:
docker exec -t lab1-postgres-1 pg_dump -U lab -d demo > demo_backup_$(date +%Y%m%d).sql
; –ó–∞–ø—É—Å–∫–∞–µ—Ç pg_dump –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
; –î–µ–ª–∞–µ—Ç –¥–∞–º–ø –±–∞–∑—ã demo
; –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ —Ñ–∞–π–ª —Å –¥–∞—Ç–æ–π, –Ω–∞–ø—Ä–∏–º–µ—Ä: demo_backup_20250917.sql

; –ï—Å–ª–∏ –±–∞–∑–∞ –±–æ–ª—å—à–∞—è (3.1 –ì–ë!), –ª—É—á—à–µ —Å–∂–∞—Ç—å:
docker exec -t lab1-postgres-1 pg_dump -U lab -d demo | gzip > demo_backup_$(date +%Y%m%d).sql.gz
docker exec -t lab1-postgres-1 pg_dump -U lab -d demo | pigz > demo_backup_$(date +%Y%m%d).sql.gz
; –¢–æ–≥–¥–∞ —Ñ–∞–π–ª –±—É–¥–µ—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä: demo_backup_20250917.sql.gz ‚Äî –≤ 5-10 —Ä–∞–∑ –º–µ–Ω—å—à–µ.
; –°–æ—Ö—Ä–∞–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å—Ö–µ–º—É
docker exec -t lab1-postgres-1 pg_dump -U lab -d demo --schema-only > demo_schema.sql

# 1. –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –±–∞–∑—É
docker exec -i lab1-postgres-1 psql -U lab -d postgres -c "DROP DATABASE IF EXISTS demo;"
# 2. –°–æ–∑–¥–∞—ë–º —á–∏—Å—Ç—É—é
docker exec -i lab1-postgres-1 psql -U lab -d postgres -c "CREATE DATABASE demo;"
# 3. –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ —Å–∂–∞—Ç–æ–≥–æ –¥–∞–º–ø–∞
gunzip < demo_backup_20250917.sql.gz | docker exec -i lab1-postgres-1 psql -U lab -d demo
# 3. –ï—Å–ª–∏ .sql –∞ –Ω–µ .gz
docker exec -i lab1-postgres-1 psql -U lab -d demo < demo_backup_20250917.sql
# 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º
docker exec -it lab1-postgres-1 psql -U lab -d demo -c "\dt"


# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker run [OPTIONS] IMAGE [COMMAND] [ARG...]

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker ps

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–≤–∫–ª—é—á–∞—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ)
docker ps -a

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker stop CONTAINER_NAME_OR_ID

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker start CONTAINER_NAME_OR_ID

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker restart CONTAINER_NAME_OR_ID

# –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker rm CONTAINER_NAME_OR_ID

# –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –≤ –∑–∞–ø—É—â–µ–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker exec -it CONTAINER_NAME_OR_ID COMMAND

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—ã
docker images

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–±—Ä–∞–∑
docker pull IMAGE_NAME

# –£–¥–∞–ª–∏—Ç—å –æ–±—Ä–∞–∑
docker rmi IMAGE_NAME

# –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –æ–±—Ä–∞–∑ –∏–∑ Dockerfile
docker build -t IMAGE_NAME .

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker logs CONTAINER_NAME_OR_ID

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker logs -f CONTAINER_NAME_OR_ID

# –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker inspect CONTAINER_NAME_OR_ID

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã –≤ —Ñ–æ–Ω–µ
docker-compose up -d

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose up -d --force-recreate

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker-compose stop

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose start

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker-compose restart

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose ps

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose logs

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs SERVICE_NAME

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker-compose logs -f

# –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –≤ —Å–µ—Ä–≤–∏—Å–µ
docker-compose exec SERVICE_NAME COMMAND

# –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL:
docker-compose exec postgres psql -U postgres

# –í—Ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä bash
docker-compose exec SERVICE_NAME bash

# –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–µ–∫—Ç–∞
cd ~/Study/data_base

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä
docker-compose down

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker-compose ps

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
docker-compose exec postgres psql -U postgres

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –±–∞–∑–µ
docker-compose exec postgres psql -U postgres -d pagila

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–∞
docker-compose exec postgres psql -U postgres -c "SHOW data_checksums;"

# –°–ø–∏—Å–æ–∫ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
docker-compose exec postgres psql -U postgres -c "\l"

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ pagila
docker-compose exec postgres psql -U postgres -d pagila -c "\dt"

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
docker-compose logs postgres

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Å—É–º–º
docker-compose exec postgres psql -U postgres -c "SHOW data_checksums;"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫–∏–µ –ø–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã
sudo netstat -tlnp | grep :5432

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π PostgreSQL (–µ—Å–ª–∏ –º–µ—à–∞–µ—Ç)
sudo systemctl stop postgresql

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cat .env

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏–∏
docker --version
docker-compose --version